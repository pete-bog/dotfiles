# set editor to vi or vim
VIM_INSTALL="$(which vim)"
if [[ -z "$VIM_INSTALL" ]]; then
    VIM_INSTALL="$(which vi)"
fi
export EDITOR=$VIM_INSTALL
export VISUAL=$VIM_INSTALL

# ##### Aliases #######
# Git
alias gs="git status"
alias gc="git commit -m"
alias ga="git add"
alias gaa="git add -A && git status"
alias gac="git add -A && git status && git commit -m"
alias gco="git checkout"
alias gr="git reset"
alias gp="git push"
alias gl="git pull"
alias gg="git gui"
alias g="git"
# other
alias grep="grep --color=always"
alias less="less -R"
# virtualenv
alias activate="source .venv/bin/activate"
# tmux
alias t="tmux"

############# PROMPT ###############
color_green="$(tput setaf 2)"
color_blue="$(tput setaf 4)"
color_purple="$(tput setaf 5)"
color_cyan="$(tput setaf 6)"
color_reset="$(tput sgr0)"
update_prompt() {
    current_branch=$(/usr/bin/git rev-parse --abbrev-ref HEAD 2> /dev/null)
    if [[ $? -eq 0 ]]; then
        prompt_git="$color_purple$current_branch"
    else
        prompt_git=""
    fi

    if [[ -z "$VIRTUAL_ENV" ]]; then
        prompt_venv=""
    else
        prompt_venv="$color_cyan($(basename $(dirname $VIRTUAL_ENV))) "
    fi
    PS1="$prompt_venv$color_green\u@\h $color_blue\w $prompt_git$color_reset\nÂ» "
}
PROMPT_COMMAND="update_prompt"

# set user@host cwd in terminal title
case ${TERM} in
  xterm*|rxvt*|Eterm|aterm|kterm|gnome*)
     PROMPT_COMMAND=${PROMPT_COMMAND:+$PROMPT_COMMAND; }'printf "\033]0;%s@%s:%s\007" "${USER}" "${HOSTNAME%%.*}" "${PWD/#$HOME/\~}"'

    ;;
  screen*)
    PROMPT_COMMAND=${PROMPT_COMMAND:+$PROMPT_COMMAND; }'printf "\033_%s@%s:%s\033\\" "${USER}" "${HOSTNAME%%.*}" "${PWD/#$HOME/\~}"'
    ;;
esac

############## OS specific ##################
if [ "$(uname)" == "Darwin" ]; then
    # mac os specifics here
    alias ls="ls -G"
    alias ll="ls -lG"
    alias l="ls -lGA"
elif [ "$(uname)" == "Linux" ]; then
    # linux specifics here
    alias ls="ls --color=auto"
    alias ll="ls -l --color=auto"
    alias l="ls -lA --color=auto"
    alias lla="ls -lA --color=auto"

    # copy and paste aliases
    alias copy="xclip -i -selection clipboard"
    alias paste="xclip -o -selection clipboard"

    # distro specific
    distro=$(cat /etc/os-release | grep --color=never "^NAME=")
    distro=${distro:5}
    distro=$(echo $distro | sed 's/"//g')
    if [ "$distro" == "Ubuntu" ]; then
        alias pkg="apt show"
        alias pkginstall="sudo apt install"
        alias pkgi="sudo apt install"
        alias pkgremove="sudo apt remove"
        alias pkgr="sudo apt remove"
        alias pkgsearch="apt search"
        alias pkgs="apt search"
        alias pkgupdate="sudo apt update && sudo apt upgrade -y"
        alias pkgu="sudo apt update && sudo apt upgrade -y"
    fi
fi

############## ENVIRONMENT VARIABLES ##############
# pyenv
export PYENV_ROOT=~/.pyenv
export PATH="$PYENV_ROOT/bin:$PATH"
eval "$(pyenv init -)"

# pipenv
export PIPENV_VENV_IN_PROJECT=1
# poetry
export POETRY_VIRTUALENVS_IN_PROJECT=true

# Path modifications
export PATH=~/development/environment/scripts/:$PATH
export PATH=~/.local/bin:$PATH
